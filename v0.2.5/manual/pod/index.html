<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Proper orthogonal decomposition (POD) · ILMPostProcessing.jl</title><meta name="title" content="Proper orthogonal decomposition (POD) · ILMPostProcessing.jl"/><meta property="og:title" content="Proper orthogonal decomposition (POD) · ILMPostProcessing.jl"/><meta property="twitter:title" content="Proper orthogonal decomposition (POD) · ILMPostProcessing.jl"/><meta name="description" content="Documentation for ILMPostProcessing.jl."/><meta property="og:description" content="Documentation for ILMPostProcessing.jl."/><meta property="twitter:description" content="Documentation for ILMPostProcessing.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ILMPostProcessing.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Proper orthogonal decomposition (POD)</a><ul class="internal"><li><a class="tocitem" href="#Get-the-flow-field-data"><span>Get the flow field data</span></a></li><li><a class="tocitem" href="#Assemble-snapshots-of-the-velocity-field-from-the-solution-data"><span>Assemble snapshots of the velocity field from the solution data</span></a></li><li><a class="tocitem" href="#Perform-the-POD"><span>Perform the POD</span></a></li></ul></li><li><a class="tocitem" href="../dmdtest/">Dynamic mode decomposition (DMD)</a></li><li><a class="tocitem" href="../ftle_continuous/">Finite-Time Lyapunov Exponent (FTLE) with Continuous Velocity Field</a></li><li><a class="tocitem" href="../ftle/">Finite-Time Lyapunov Exponent (FTLE)</a></li><li><a class="tocitem" href="../lavd/">Lagrangian-averaged vorticity deviation (LAVD)</a></li><li><a class="tocitem" href="../functions/">Functions and types</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Proper orthogonal decomposition (POD)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Proper orthogonal decomposition (POD)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ILMPostProcessing.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaIBPM/ILMPostProcessing.jl/blob/master/test/literate/pod.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Proper-orthogonal-decomposition-(POD)"><a class="docs-heading-anchor" href="#Proper-orthogonal-decomposition-(POD)">Proper orthogonal decomposition (POD)</a><a id="Proper-orthogonal-decomposition-(POD)-1"></a><a class="docs-heading-anchor-permalink" href="#Proper-orthogonal-decomposition-(POD)" title="Permalink"></a></h1><p>In this example, we will demonstrate the use of proper orthogonal decomposition (POD) for decomposing a flow field into basis modes.</p><pre><code class="language-julia hljs">using ILMPostProcessing
using Plots</code></pre><h2 id="Get-the-flow-field-data"><a class="docs-heading-anchor" href="#Get-the-flow-field-data">Get the flow field data</a><a id="Get-the-flow-field-data-1"></a><a class="docs-heading-anchor-permalink" href="#Get-the-flow-field-data" title="Permalink"></a></h2><p>First, we need some flow field data to analyze. For this purpose, we will use <a href="https://github.com/JuliaIBPM/ViscousFlow.jl">ViscousFlow.jl</a> to get snapshots of the flow for a flat plate at 30 degrees angle of attack at Reynolds number 100.</p><pre><code class="language-julia hljs">using ViscousFlow

my_params = Dict()
my_params[&quot;Re&quot;] = 100
my_params[&quot;freestream speed&quot;] = 1.0 # in x-dir
my_params[&quot;freestream angle&quot;] = 0.0 # relative to horizontal

xlim = (-1.0, 5.0)
ylim = (-2.0, 2.0)
my_params[&quot;grid Re&quot;] = 4.0

g = setup_grid(xlim, ylim, my_params)

Δs = surface_point_spacing(g, my_params)
body = Plate(1.0, Δs)

cent = [0.5,0.0]
α = -30π/180
X = MotionTransform(cent, α)
joint = Joint(X)

m = RigidBodyMotion(joint, body)
x = init_motion_state(body, m)
update_body!(body, x, m)
sys = viscousflow_system(g, body, phys_params = my_params, motions = m);

u0 = init_sol(sys)
tspan = (0.0, 20.0)
integrator = init(u0, tspan, sys)

# Solve to 10 convective time units
step!(integrator, 10)</code></pre><h2 id="Assemble-snapshots-of-the-velocity-field-from-the-solution-data"><a class="docs-heading-anchor" href="#Assemble-snapshots-of-the-velocity-field-from-the-solution-data">Assemble snapshots of the velocity field from the solution data</a><a id="Assemble-snapshots-of-the-velocity-field-from-the-solution-data-1"></a><a class="docs-heading-anchor-permalink" href="#Assemble-snapshots-of-the-velocity-field-from-the-solution-data" title="Permalink"></a></h2><p>Here, we make use of the capability of the <code>velocity</code> function to generate an array of velocity fields at a range of times. We will save every 5th time step in this array.</p><pre><code class="language-julia hljs">sol = integrator.sol
tpod = sol.t[2:5:end]
X = velocity(sol, sys, tpod);</code></pre><h2 id="Perform-the-POD"><a class="docs-heading-anchor" href="#Perform-the-POD">Perform the POD</a><a id="Perform-the-POD-1"></a><a class="docs-heading-anchor-permalink" href="#Perform-the-POD" title="Permalink"></a></h2><p>The POD is simply performed with the <code>PODModes</code> function. This provides a structure containing the modes (<code>phi</code>), the expansion coefficients (<code>a</code>), and the modal energies (<code>lambda</code>). By default, <code>PODModes</code> retains 99% of the energy. This can be changed with the optional argument <code>tolerance</code>.</p><pre><code class="language-julia hljs">modes = pod(X);</code></pre><p>The <code>a</code> array is of size <span>$N_t \times r$</span>, where <span>$N_t$</span> is the number of time values, and <span>$r$</span> is the number of modes. The modes are ordered from highest energy to lowest energy.</p><pre><code class="language-julia hljs">modes.a</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">101×10 Matrix{Float64}:
 -0.127829   -0.0205526   -0.0934595   …  -0.0261613   -0.0194217
 -0.126472   -0.0204801   -0.092165       -0.0191484   -0.0127088
 -0.124483   -0.0205471   -0.0910545      -0.0112199   -0.00573007
 -0.122052   -0.0211047   -0.0901648      -0.00324336   0.000669337
 -0.119366   -0.022382    -0.0893463       0.00384628   0.00587694
 -0.116625   -0.0244775   -0.0883639   …   0.00937509   0.00962801
 -0.11403    -0.0273593   -0.0869465       0.0130776    0.0119428
 -0.111764   -0.0308768   -0.084829        0.0150722    0.0129652
 -0.109975   -0.0347842   -0.081787        0.015724     0.0128208
 -0.108763   -0.0387704   -0.077662        0.0154636    0.011562
  ⋮                                    ⋱               
  0.120317   -0.00797233  -0.0592999      -0.0128034    0.0121917
  0.119611   -0.0248094   -0.0566038      -0.00833961   0.0122792
  0.117271   -0.0411946   -0.051381       -0.00274982   0.0106887
  0.113317   -0.0567312   -0.0437124   …   0.0033735    0.00770352
  0.107812   -0.0710461   -0.0337484       0.00941741   0.00377243
  0.100871   -0.0837987   -0.0217102       0.0148343   -0.000583221
  0.0926609  -0.0946883   -0.00788903      0.0192084   -0.00486839
  0.0834028  -0.103458     0.00735766      0.0222909   -0.00869598
  0.0733662  -0.109901     0.023615    …   0.0239988   -0.0118315</code></pre><p>In this case, 7 modes were retained, at 51 times.</p><p>If we wanted to re-assemble the modes and coefficients to recover the flow at some time instant, we could use the <code>mapreduce</code> function, e.g.,</p><pre><code class="language-julia hljs">vel_assemble = mapreduce((aj, phi_j) -&gt; aj .* phi_j, +, modes.a[end,:], modes.phi) + modes.Xmean</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">CartesianGrids.Edges{CartesianGrids.Primal, 154, 104, Float64, Vector{Float64}} data
u (in grid orientation)
103×154 Matrix{Float64}:
 1.01998   1.02109   1.02225   1.02345   …  0.996423  0.995262  0.994149
 1.01938   1.02051   1.02169   1.02291      0.99542   0.994238  0.993108
 1.01874   1.01989   1.02108   1.02232      0.994366  0.993164  0.992015
 1.01805   1.01922   1.02043   1.02169      0.993258  0.992035  0.990869
 1.01732   1.0185    1.01973   1.02101      0.992093  0.990849  0.989666
 1.01654   1.01773   1.01898   1.02028   …  0.990868  0.989604  0.988404
 1.0157    1.01691   1.01817   1.01949      0.98958   0.988297  0.98708
 1.01481   1.01603   1.01731   1.01864      0.988226  0.986923  0.98569
 1.01387   1.01509   1.01638   1.01773      0.986802  0.985481  0.984233
 1.01286   1.01409   1.01539   1.01676      0.985305  0.983966  0.982703
 ⋮                                       ⋱                      
 0.958254  0.958135  0.95805   0.958001     1.04658   1.04476   1.04278
 0.959402  0.959316  0.959263  0.959247  …  1.0444    1.04275   1.04098
 0.960519  0.960463  0.96044   0.960453     1.04233   1.04085   1.03925
 0.961605  0.961576  0.961581  0.961622     1.04039   1.03905   1.03761
 0.962659  0.962657  0.962687  0.962752     1.03855   1.03735   1.03605
 0.963683  0.963705  0.963759  0.963846     1.03683   1.03574   1.03456
 0.964677  0.964721  0.964796  0.964904  …  1.03521   1.03422   1.03315
 0.965641  0.965705  0.9658    0.965927     1.03368   1.03279   1.03181
 0.966576  0.966659  0.966771  0.966915     1.03224   1.03143   1.03054
v (in grid orientation)
104×153 Matrix{Float64}:
  0.0578623   0.0584034   0.0589246  …  -0.068873   -0.067919   -0.0669443
  0.058978    0.0595598   0.0601222     -0.070083   -0.0690802  -0.0680567
  0.0601109   0.0607357   0.0613416     -0.0713162  -0.0702619  -0.0691872
  0.0612604   0.0619305   0.0625824     -0.0725725  -0.0714643  -0.0703356
  0.0624255   0.0631436   0.0638442     -0.0738523  -0.0726871  -0.0715017
  0.0636056   0.0643743   0.0651264  …  -0.0751553  -0.0739303  -0.0726852
  0.0647994   0.0656214   0.0664281     -0.0764815  -0.0751935  -0.0738858
  0.0660058   0.0668841   0.0677483     -0.0778309  -0.0764765  -0.0751028
  0.0672233   0.0681608   0.0690858     -0.0792031  -0.0777788  -0.0763357
  0.0684502   0.0694501   0.0704392     -0.0805977  -0.0790998  -0.0775837
  ⋮                                  ⋱   ⋮                      
 -0.0227226  -0.0239034  -0.0251168  …   0.0205252   0.0227409   0.0248426
 -0.0228092  -0.0239562  -0.0251333      0.0190163   0.021099    0.023064
 -0.0228654  -0.0239789  -0.0251201      0.0176642   0.0196214   0.0214628
 -0.0228935  -0.023974   -0.0250799      0.0164504   0.0182898   0.0200184
 -0.0228957  -0.0239436  -0.0250149      0.015359    0.0170878   0.0187129
 -0.022874   -0.0238899  -0.0249271  …   0.0143758   0.0160009   0.0175306
 -0.0228303  -0.0238147  -0.0248187      0.0134883   0.0150164   0.0164575
 -0.0227664  -0.02372    -0.0246914      0.0126855   0.0141231   0.0154817
 -0.022684   -0.0236074  -0.024547       0.0119579   0.0133108   0.0145923</code></pre><p>In this last line, <code>modes.a[end,:]</code> obtains the expansion coefficients at the last time available.</p><p>Let&#39;s print the first mode, and the corresponding history of the modal coefficient in the decomposition</p><pre><code class="language-julia hljs">plot(layout=[2;1],plot(modes.phi[1].u,sys,title=&quot;u&quot;),
   plot(modes.phi[1].v,sys,title=&quot;v&quot;),
   plot(tpod,modes.a[:,1],xlim=(0,Inf),xlabel=&quot;\$t\$&quot;,ylabel=&quot;\$a_1(t)\$&quot;))</code></pre><img src="cb0884e2.svg" alt="Example block output"/><p>The energy associated with this mode is</p><pre><code class="language-julia hljs">modes.lambda[1]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.6850205021236457</code></pre><p>Now let&#39;s print the <span>$r$</span>th mode, and the history of the coefficient in the decomposition</p><pre><code class="language-julia hljs">plot(layout=[2;1],plot(modes.phi[end].u,sys,title=&quot;u&quot;),
   plot(modes.phi[end].v,sys,title=&quot;v&quot;),
   plot(tpod,modes.a[:,end],xlim=(0,Inf),xlabel=&quot;\$t\$&quot;,ylabel=&quot;\$a_r(t)\$&quot;))</code></pre><img src="ee251714.svg" alt="Example block output"/><p>The energy associated with this mode is</p><pre><code class="language-julia hljs">modes.lambda[end]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.007771058916093473</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../dmdtest/">Dynamic mode decomposition (DMD) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Wednesday 18 June 2025 03:09">Wednesday 18 June 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
